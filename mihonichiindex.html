// JANコードから複数の商品情報を検索して表示する関数
    async function fetchItemName(input) {
        const jan = input.value;
        const display = input.parentElement.querySelector('.item-name-display');
        if (!jan) { 
            display.innerHTML = ""; 
            return; 
        }
        
        display.innerHTML = "<i class='fas fa-spinner fa-spin'></i> 検索中...";
        display.style.color = "#666";

        try {
            const res = await fetch(flowUrl, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ action: "lookup", jan: jan })
            });
            const data = await res.json();
            
            if (data.itemName) {
                // 品番、品名、単価、在庫状況をレイアウトして表示
                display.innerHTML = `
                    <div style="background: #eef9f1; padding: 10px; border-radius: 8px; margin-top: 5px; border: 1px solid #d4edda; text-align: left;">
                        <div style="font-size: 11px; color: #666;">品番: ${data.partNo || '---'}</div>
                        <div style="font-size: 15px; color: #2c3e50; margin: 3px 0;"><strong>${data.itemName}</strong></div>
                        <div style="display: flex; justify-content: space-between; font-size: 13px;">
                            <span style="color: #e67e22;">単価: ¥${data.price ? Number(data.price).toLocaleString() : '---'}</span>
                            <span style="color: ${data.stock > 0 ? '#28a745' : '#ff4d4d'};">
                                在庫: ${data.stock > 0 ? data.stock + ' 個' : '欠品中'}
                            </span>
                        </div>
                    </div>
                `;
            } else {
                display.innerHTML = "<div style='color: #ff4d4d; padding: 5px;'>⚠️ 商品が見つかりません</div>";
            }
        } catch (e) {
            display.innerHTML = "<div style='color: #ff4d4d;'>検索エラーが発生しました</div>";
        }
    }
